<% if @changeset.valid? -%>
<article class="clearfix<%= ' unmerged' unless @changeset.merged %>" id="cs-<%= @changeset.id.to_s %>" data-rev="<%= @changeset.revision.to_s %>">
  <section class="actions">
    <%= link_to tag('img', { :src => '/images/pencil_icon.gif', :title => 'Edit ' + @changeset.revision.to_s }), '#', :class => 'edit' %>
    <%= link_to tag('img', { :src => '/images/x_icon.gif', :title => 'Delete ' + @changeset.revision.to_s }), '#', :class => 'delete' %>
    <%= link_to tag('img', { :src => '/images/switch_icon.gif', :title => 'Merge ' + @changeset.revision.to_s }), '#', :class => 'merge' %>
  </section>
  <section class="revision"><%= @changeset.revision.to_s %> <%= link_to '&rarr;', changeset_link(@changeset.revision.to_s), :target => '_blank' %></section>
  <section class="ticket"><%= @changeset.ticket ? @changeset.ticket.to_s : '&nbsp;' %> <%= link_to '&rarr;', ticket_link(@changeset.ticket.to_s), :target => '_blank' unless @changeset.ticket.blank? %></section>
  <section class="description"><%= @changeset.description %></section>
  <section class="notes"><%= @changeset.notes %></section>
</article>

<article class="hidden clearfix<%= ' unmerged' unless @changeset.merged %>" id="cs-edit-<%= @changeset.id.to_s %>">
  <form>
    <section class="actions">
      <a href="#" data-id="<%= @changeset.id.to_s %>" class="save"><img src="/images/disk_icon.gif" width="16" height="16" alt="Save" title="Save <%= @changeset.revision.to_s %>"></a>
      <a href="#" class="cancel"><img src="/images/cancel_icon.gif" width="16" height="16" alt="Cancel" title="Cancel changes" /></a>
      <img src="/images/ajax_loader.gif" width="16" height="11" alt="Loading" class="loading hidden" />
      <input type="hidden" name="_method" value="put" />
    </section>
    <section class="revision"><input type="text" name="changeset[revision]" value="<%= @changeset.revision.to_s %>" /></section>
    <section class="ticket"><input type="text" name="changeset[ticket]" value="<%= @changeset.ticket.to_s %>" /></section>
    <section class="description"><input type="text" name="changeset[description]" value="<%= @changeset.description %>" /></section>
    <section class="notes"><input type="text" name="changeset[notes]" value="<%= @changeset.notes %>" /></section>
  </form>
</article>
<% else -%>
<div class="errors">
  <p>The changeset could not be saved because:</p>
  
  <ul>
    <% @changeset.errors.each do |cs| -%>
      <li><%= cs[0] + ' ' + cs[1] %></li>
    <% end -%>
  </ul>
</div>
<% end -%>